# CVE-2020-10263

## [Discoverer]

*Jian-Xian Li, Pei-Jing Sun, Guan-Wei Hou, Jieh-Chian Wu

National Kaohsiung University of Science and Technology

## [Description]
An issue was discovered on XIAOMI XIAOAI speaker Pro LX06 1.52.4. Attackers can get root shell by accessing the UART interface and then they can (i) read Wi-Fi SSID or password, (ii) read the dialogue text files between users and XIAOMI XIAOAI speaker Pro LX06, (iii) use Text-To-Speech tools pretend XIAOMI speakers' voice achieve social engineering attacks, (iv) eavesdrop on users and record what XIAOMI XIAOAI speaker Pro LX06 hears, (v) modify system files, (vi) use commands to send any IR code through IR emitter on XIAOMI XIAOAI Speaker Pro LX06, (vii) stop voice assistant service, (viii) enable the XIAOMI XIAOAI Speaker Pro’ SSH or TELNET service as a backdoor.(IX) tampering with the router configuration of the lan.
## [Attack Type] 
Physical

## [Product]
XIAOMI XIAOAI speaker Pro (LX06)

## [Version]
1.52.4

## XIAOMI XIAOAI speaker Pro devices vulnerability
### demonstration

Debug points exist in most of the equipment and are used for factory testing or debug. By removing the case of the XIAOMI XIAOAI speaker Pro, we can find the debug point on the UART port. Figure 1 shows how a PC is connected to XIAOMI XIAOAI speaker Pro via UART port.

<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_1.jpg" width="50%" height="50%" />

Fig.1 A PC is connected to XIAOMI XIAOAI speaker Pro via UART port
</center></div>

Since there is no any authentication procedure for the access to the UART ports, we can login as root with no password to be asked. Figure 2 shows the screenshot of login as root with no password to be asked.

<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_2.jpg" width="50%" height="50%" />

Fig.2 Login as root with no password to be asked.

</center></div>

## Impact demonstration from XIAOMI XIAOAI speaker Pro devices vulnerability
### 1. Read Wi-Fi SSID or password displayed in cleartext
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_3.jpg" width="50%" height="50%" />
 
Fig.3 Show the WIFI SSID and password
</center></div>

### 2. Read the dialogue text files between users and XIAOMI XIAOAI speaker Pro
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_4.png" width="50%" height="50%" />
 
Fig.4 Part of the texts transferred from conversations between the user and XIAOMI XIAOAI speaker Pro
</center></div>

### 3. Use Text-To-Speech tools pretend XIAOMI XIAOAI speaker Pro' voice achieve social engineering attacks



video：



### 4. Eavesdrop on users and record what XIAOMI XIAOAI speaker Pro hears
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10262_7.jpg" width="60%" height="80%" />
 
Fig.5 Recording the conversations and show the produced wave files
</center></div>

### 5. Stop voice assistant service
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_7.png" width="50%" height="50%" />
 
Fig.6 The command to shut d own voice assistant of XIAOMI speaker
</center></div>

### 6. Enable the XIAOMI XIAOAI speaker Pro’s SSH service as a backdoor
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_8.png" width="50%" height="50%" />
 
Fig.7 The command to use a RSA format SSH private key
</center></div>
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_9.png" width="50%" height="50%" />
 
Fig.8 The command to remotely login in by SSH with no password to be asked
</center></div>

### 7. Enable the XIAOMI XIAOAI speaker Pro’s Telnet service as a backdoor
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_10.png" width="50%" height="50%" />
 
Fig.9 The start Telnet command
Fig.
</center></div>

<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_11.png" width="50%" height="50%" />
 
Fig.10 The command to remotely login in by Telnet with no password to be asked.

### 8. Use command to send any IR code through IR emitter on XIAOMI XIAOAI Speaker Pro
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_12.jpg" width="50%" height="50%" />
 
Fig.11 The IR emitter on XIAOMI XIAOAI Speaker Pro
</center></div>

<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_13.png" width="70%" height="70%" />
 
Fig.12 The command to send any IR code

### 9. Tampering with the router configuration of the lan
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_14.jpg" width="50%" height="50%" />
 
Fig.13 Router configuration before tampering
</center></div>

<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_17.jpg" width="50%" height="50%" />
 
Fig.14 The command to tamper with the router configuration 
</center></div>

<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_16.jpg" width="50%" height="50%" />
 
Fig.15 Router configuration after tampering
