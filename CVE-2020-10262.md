# CVE-2020-10262

## [Discoverer]

*Jian-Xian Li, Pei-Jing Sun, Guan-Wei Hou, Jieh-Chian Wu

National Kaohsiung University of Science and Technology

## [Description]
An issue was discovered on XIAOMI XIAOAI speaker Pro LX06 1.58.10. Attackers can activate the failsafe mode during the boot process, and use the mi_console command cascaded by the SN code shown on the product to get the root shell password, and then the attacker can (i) read Wi-Fi SSID or password, (ii) read the dialogue text files between users and XIAOMI XIAOAI speaker Pro LX06, (iii) use Text-To-Speech tools pretend XIAOMI speakers' voice achieve social engineering attacks, (iv) eavesdrop on users and record what XIAOMI XIAOAI speaker Pro LX06 hears, (v) modify system files, (vi) use commands to send any IR code through IR emitter on XIAOMI XIAOAI Speaker Pro (LX06), (vii) stop voice assistant service, (viii) enable the XIAOMI XIAOAI Speaker Pro’s SSH or  TELNET service as a backdoor, (IX) tamper with the router configuration of the router in the local area networks.
## [Attack Type] 
Physical

## [Product]
XIAOMI XIAOAI speaker Pro (LX06)

## [Version]
1.58.10

## XIAOMI XIAOAI speaker Pro devices vulnerability
### demonstration

A ttackers can activate the failsafe mode during the boot process, and use the mi_console command cascaded by the SN code shown on the pro duct to get the root shell password.

<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10262_1.jpg" width="50%" height="50%" />

Fig.1 The SN code shown on the XIAOMI XIAOAI speaker Pro
</center></div>

<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10262_2.png" width="50%" height="50%" />

Fig.2 Get root shell password in the failsafe mode

</center></div>

<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10262_3.png" width="50%" height="50%" />
 
Fig.3 Login root shell
</center></div>

## Impact demonstration from XIAOMI XIAOAI speaker Pro devices vulnerability
### 1. Read Wi-Fi SSID or password displayed in cleartext
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10262_4.jpg" width="50%" height="50%" />
 
Fig.4 Show the WIFI SSID and password
</center></div>

### 2. Read the dialogue text files between users and XIAOMI XIAOAI speaker Pro
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10262_5.png" width="50%" height="50%" />
 
Fig.5 Part of the texts transferred from conversations between the user and XIAOMI XIAOAI speaker Pro
</center></div>

### 3. Use Text-To-Speech tools pretend XIAOMI XIAOAI speaker Pro' voice achieve social engineering attacks



video：https://www.youtube.com/watch?v=Cr5DupGxmL4



### 4. Eavesdrop on users and record what XIAOMI XIAOAI speaker Pro hears
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10262_7.jpg" width="60%" height="80%" />
 
Fig.6 Recording the conversations and show the produced wave files
</center></div>

### 5. Stop voice assistant service
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10262_8.png" width="50%" height="50%" />
 
Fig.7 The command to shut down voice assistant of XIAOMI speaker
</center></div>

### 6. Enable the XIAOMI XIAOAI speaker Pro’s SSH service as a backdoor
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10262_9.png" width="50%" height="50%" />
 
Fig.8 The command to use a RSA format SSH private key
</center></div>
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10262_10.png" width="50%" height="50%" />
 
Fig.9 The command to remotely login SSH
</center></div>

### 7. Enable the XIAOMI XIAOAI speaker Pro’s Telnet service as a backdoor
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10262_11.png" width="50%" height="50%" />
 
Fig.10 The start Telnet command
</center></div>

<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10262_12.png" width="50%" height="50%" />
 
Fig.11 The command to remotely login Telnet

### 8.Use command to send any IR code through IR emitter on XIAOMI XIAOAI Speaker Pro
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10262_13.jpg" width="50%" height="50%" />
 
Fig.12 The IR emitter on XIAOMI XIAOAI Speaker Pro
</center></div>

<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10262_14.png" width="70%" height="70%" />
 
Fig.13 The command to send any IR code
</center></div>

### 9. Data tampering with the configuration of the router in local area network
<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_14.jpg" width="50%" height="50%" />
 
Fig.14 The router configuration before data tampering
</center></div>

<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_15.jpg" width="65%" height="65%" />
 
Fig.15 The command for data tampering with the router configuration
</center></div>

<div align=center>
<center>
<img src="https://github.com/Jian-Xian/CVE-POC/blob/master/picture/CVE-2020-10263_16.jpg" width="50%" height="50%" />
 
Fig.16 The router configuration after data tampering
